(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b95fa5b"],{"06b7":function(e,t,o){"use strict";var a=o("2e82"),r=o.n(a);r.a},"1a23":function(e,t,o){"use strict";var a=o("d630"),r=o.n(a);r.a},"1bcb":function(e,t,o){"use strict";var a=o("ce3c"),r=o.n(a);r.a},2113:function(e,t,o){"use strict";var a=o("bfd7"),r=o.n(a);r.a},"22c9":function(e,t,o){},"2e82":function(e,t,o){},"3b79":function(e,t,o){"use strict";var a=o("43d0"),r=o.n(a);r.a},"43d0":function(e,t,o){},"60b1":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{key:e.dataFormKey,ref:"ruleForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"160px"}},[o("el-row",{attrs:{gutter:0}},[e._l(e.moduleProps,(function(t){return[o("el-col",{key:t.prop,staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:e.isShowInRow(t)?24:12}},[e.isHideInForm(t.ruleType)?e._e():[o("el-form-item",{attrs:{label:t.name,prop:t.prop}},["STRING"===t.feature?o("el-input",{attrs:{moduleProp:t,autocomplete:"off",maxlength:t.length>0?t.length:60},on:{input:function(t){e.$forceUpdate()}},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"PASSWORD"===t.feature?o("el-input",{attrs:{moduleProp:t,"show-password":"",autocomplete:"off",maxlength:t.length>0?t.length:60},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"NUMBER"===t.feature?o("el-input",{attrs:{type:"number",moduleProp:t,autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TEXT"===t.feature?o("FormText",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATE"===t.feature?o("FormDate",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATETIME"===t.feature?o("FormDateTime",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TIME"===t.feature?o("FormTime",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"SELECT"===t.feature?o("FormSelect",{attrs:{moduleProp:t,showValue:e.dataForm[t.prop]},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FK"===t.feature?o("FormFK",{attrs:{moduleProp:t,showValue:e.dataForm[t.showPath]},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var r=t[a];e.$set(e.dataForm,r,o[a])}))}},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FILE"===t.feature||"IMAGE"===t.feature?o("FormFile",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"EDITOR"===t.feature?o("FormEditor",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):e._e()],1)]],2)]}))],2)],1)],1)]),e._l(e.childrenModules,(function(e){return o("section",{key:"children_section_"+e.name},[o("Children",{ref:"childrenList",refInFor:!0,attrs:{module:e}})],1)}))],2)},r=[],i=(o("4de4"),o("7db0"),o("4160"),o("b0c0"),o("d3b7"),o("159b"),o("ddb0"),o("5530")),n=o("dbb4a"),l=o("5f32"),s=o("386d"),c=o("76e9"),d=o("c0ab"),u=o("49c8"),p=o("8f3e"),h=o("88b9"),f=o("a6ea"),m=o("9670"),g=o("2f62"),b=o("1e3b"),v={name:"froms",components:{FormString:n["a"],FormText:l["a"],FormDate:s["a"],FormFK:h["a"],FormDateTime:d["a"],FormTime:u["a"],FormSelect:p["a"],FormFile:f["a"],FormEditor:c["a"],Children:m["a"]},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataFormKey:0,dataForm:{},rules:this.getFormRules(),pk:this.module.pk,moduleProps:this.module.props||[],children:this.getChildren()||[],childrenModules:[],action:{}}},created:function(){this.getChildrenModules(),this.initialize()},mounted:function(){},computed:Object(i["a"])({},Object(g["b"])(["permission"])),methods:{initialize:function(){var e=this;this.dataForm={},this.module.props.filter((function(e){return!!e.defaultValue})).forEach((function(t){e.dataForm[t.prop]=t.defaultValue||""})),this.$nextTick((function(t){e.$refs.childrenList&&e.$refs.childrenList.forEach((function(e){return e.getChildrenData()}))}))},setAction:function(e){var t=this;if(this.dataForm={},this.action=e||{},!this.action.props||this.action.props.length<=0)this.moduleProps=this.module.props;else{var o=[];this.moduleProps.forEach((function(e){var a=t.action.props.find((function(t){return e.prop===t.prop}));if(a){var r=Object(i["a"])({},e);r.defaultValue=a.value,r.values=a.values,r.ruleType|=a.ruleType,o.push(r)}})),this.moduleProps=o}this.moduleProps.filter((function(e){return!!e.defaultValue})).forEach((function(e){t.dataForm[e.prop]=e.defaultValue||""})),this.rules=this.getFormRules()},getFormRules:function(){var e={},t=this.moduleProps||[];return t.forEach((function(t){Object(b["t"])(t.ruleType)&&(e[t.prop]=[{required:!0,message:"必输项",trigger:"blur"}])})),this.dataFormKey++,e},submitForm:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return e.$message({type:"error",message:"数据验证失败，请检查输入项"}),console.log("error submit!!"),!1;var o=e.getActionDataList(),a={_data:JSON.stringify(o)};a._action=e.action.id,Object(b["c"])(e.module.name,a).then((function(t){e.initialize(),e.$emit("handleSuccess")})).catch((function(){}))}))},isHideInForm:function(e){return Object(b["m"])(e)},getChildren:function(){var e=this,t=this.module.children||[];return t=t.filter((function(t){var o=t.props||[],a=o.filter((function(t){return!t.refModuleName&&!e.isHideInForm(t.prop)})).length;return!(a>1)&&(t.otherRefProps&&1==t.otherRefProps.length)})),t},getChildrenModules:function(){var e=this;this.children.forEach((function(t){t.otherRefProps.forEach((function(o){var a=t.props.filter((function(e){return e.prop===o}))[0],r=a.refProp,i=a.refModuleName;e.childrenModules.push({name:i,pk:r})}))}))},getActionDataList:function(){var e=this,t=[{module:this.module.name,data:this.dataForm}],o=this.$refs.childrenList;return this.children.forEach((function(a,r){var i={module:a.name},n=e.childrenModules[r].pk,l=a.otherRefProps[0],s=[],c=o[r].dataListSelection;c.forEach((function(e){var t={};t[l]=e[n],s.push(t)})),i.data=s,t.push(i)})),t},isShowInRow:b["u"]}},F=v,y=(o("2113"),o("2877")),k=Object(y["a"])(F,a,r,!1,null,"19a8a694",null);t["a"]=k.exports},"6db6":function(e,t,o){"use strict";o.r(t);var a,r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-list-container"},[o("div",{staticStyle:{padding:"15px 20px 5px 20px"}},[o("el-form",{attrs:{inline:!0}},[e._l(e.filterProps||[],(function(t){return[o("el-form-item",{key:"home-filter-"+t.prop,attrs:{label:t.name}},[o("FilterItem",{attrs:{filterProp:t},on:{handleOp:function(e){t.op=e}},model:{value:t.value,callback:function(o){e.$set(t,"value",o)},expression:"filterProp.value"}})],1)]})),o("el-form-item",{key:"home-search-btn"},[o("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSearch}},[e._v("查询")])],1)],2)],1),o("div",{staticClass:"example-list-body",staticStyle:{margin:"0px 20px 20px 20px","border-top":"3px solid #d2d6de","border-bottom":"1px solid #d2d6de"}},[o("div",{staticClass:"box"},[o("div",{staticClass:"left"},[e._l(e.module.actions,(function(t){return["CREATE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default"},on:{click:function(o){return e.handleCreate(t)}}},[o("span",[e._v(e._s(t.name))])]):"UPDATE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default"},on:{click:function(o){return e.handleUpdate(t)}}},[o("span",[e._v(e._s(t.name))])]):"DELETE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default"},on:{click:function(o){return e.handleDelete(t)}}},[o("span",[e._v(e._s(t.name))])]):e._e()]}))],2),o("div",{staticClass:"right"},[o("el-button",{attrs:{type:"default",icon:"el-icon-refresh"},on:{click:e.getList}}),o("el-button",{attrs:{type:"default",icon:"el-icon-menu"},on:{click:function(t){e.dialogViewPropertyVisible=!0}}})],1)]),o("section",{},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.dataListKey,staticStyle:{width:"100%"},attrs:{data:e.dataList,fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"expand",width:"30"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form",{ref:"ruleForm",attrs:{"label-width":"150px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.module.viewProps,(function(a){return o("el-col",{key:a.prop+"_expand",attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:a.name}},[o("div",{staticStyle:{"margin-right":"15px"}},[e._v(" "+e._s(t.row[a.prop])+" ")])])],1)})),1)],1)]}}])}),o("el-table-column",{staticStyle:{padding:"0px!important"},attrs:{type:"selection",width:"38"}}),o("el-table-column",{attrs:{label:"操作",width:"78"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{padding:"4px","margin-right":"4px"},attrs:{type:"default",icon:"el-icon-document",title:"详情"},on:{click:function(o){return e.handleInfo(t.row)}}}),e.module.actions.filter((function(e){return"UPDATE"===e.act||"DELETE"===e.act})).length>0?o("el-dropdown",{attrs:{placement:"bottom",trigger:"click","hide-on-click":!1}},[o("el-button",{staticStyle:{padding:"4px"},attrs:{type:"default",icon:"el-icon-arrow-right",title:"更多"}}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.module.actions,(function(a){return["UPDATE"===a.act?o("el-dropdown-item",{key:"list_update_"+a.name,nativeOn:{click:function(o){return e.handleUpdateRow(t.row,a)}}},[o("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(a.name)+" ")]):e._e(),"DELETE"===a.act?o("el-dropdown-item",{key:"list_delete_"+a.name,nativeOn:{click:function(o){return e.handleDeleteRow(t.row,a)}}},[o("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(a.name)+" ")]):e._e()]}))],2)],1):e._e()]}}])}),e._l(e.viewProps,(function(t){return[e.isHideInList(t.ruleType)?e._e():o("el-table-column",{key:t.prop,attrs:{label:t.name,prop:t.prop},scopedSlots:e._u([{key:"default",fn:function(a){return[o("div",[e._v(e._s(a.row[t.prop]))])]}}],null,!0)})]}))],2),o("div",{staticClass:"crud-pagination"},[o("el-pagination",{attrs:{"current-page":e.pageRequest.page,"page-sizes":[10,20,50,100],"page-size":e.pageRequest.size,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.pageRequest.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),o("el-dialog",{attrs:{visible:e.dialogViewPropertyVisible,left:"","close-on-click-modal":!0},on:{"update:visible":function(t){e.dialogViewPropertyVisible=t},dragDialog:e.handleDialogDrag}},[o("div",{attrs:{slot:"title"},slot:"title"},[e._v("选择可显示列")]),o("div",{staticStyle:{"margin-top":"-25px"}},[o("div",{staticStyle:{padding:"0px",margin:"0px"}},[o("div",{staticStyle:{"margin-top":"0px",padding:"20px 15px","border-top":"1px solid #d2d6de","line-height":"28px"}},[o("el-checkbox-group",{model:{value:e.viewPropArray,callback:function(t){e.viewPropArray=t},expression:"viewPropArray"}},[o("el-row",[e._l(e.module.viewProps,(function(t,a){return[e.isHideInList(t.ruleType)?e._e():o("el-col",{key:"dialog_"+t.prop+a,attrs:{xs:12,sm:8}},[o("el-checkbox",{attrs:{label:t.prop}},[e._v(e._s(t.name))])],1)]}))],2)],1)],1),o("div",{staticStyle:{"text-align":"center","margin-top":"0px","border-top":"1px solid #f2f2f2",padding:"10px 10px 0px 10px","margin-bottom":"-15px"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectedViewPropArray=e.viewPropArray,e.dialogViewPropertyVisible=!1}}},[e._v("确定")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogViewPropertyVisible=!1}}},[e._v("取消")])],1)])])]),o("el-dialog",{attrs:{visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"80%",title:"新建"+e.module.showName},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.openFormDialog}},[o("Form",{ref:"dialogForm",attrs:{module:e.module},on:{handleSuccess:e.handleCreateSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleFormSave}},[e._v("保存")]),o("el-button",{attrs:{type:"danger"},on:{click:e.handleFormReset}},[e._v("重置")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1),o("el-dialog",{attrs:{visible:e.dialogEditVisible,"close-on-click-modal":!1,width:"80%",title:"修改"+e.module.showName},on:{"update:visible":function(t){e.dialogEditVisible=t},open:e.openEditDialog}},[o("Edit",{ref:"dialogEdit",attrs:{module:e.module},on:{handleUpdateSuccess:e.handleEditUpdateSuccess,handleDeleteSuccess:e.handleEditDeleteSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleEditSave}},[e._v("保存")]),e._l(e.module.actions,(function(t){return["DELETE"===t.act?o("el-button",{key:"edit_footer_act_"+t.id,attrs:{type:"danger"},on:{click:e.handleEditDelete}},[e._v(" "+e._s(t.name)+" ")]):e._e()]})),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogEditVisible=!1}}},[e._v("取消")])],2)],1),o("el-dialog",{attrs:{visible:e.dialogInfoVisible,"close-on-click-modal":!1,width:"80%",title:e.module.showName+"详情"},on:{"update:visible":function(t){e.dialogInfoVisible=t},open:e.openInfoDialog}},[o("Info",{ref:"dialogInfo",attrs:{module:e.module},on:{handleDeleteSuccess:e.handleInfoDeleteSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e._l(e.module.actions,(function(t){return["UPDATE"===t.act?o("el-button",{key:"info_footer_act_"+t.id,attrs:{type:"danger"},on:{click:e.handleInfoUpdate}},[e._v(" "+e._s(t.name)+" ")]):e._e(),"DELETE"===t.act?o("el-button",{key:"info_footer_act_"+t.id,attrs:{type:"danger"},on:{click:e.handleInfoDelete}},[e._v(" "+e._s(t.name)+" ")]):e._e()]})),o("el-button",{attrs:{type:"danger"},on:{click:e.handleInfoRefresh}},[e._v("刷新")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogInfoVisible=!1}}},[e._v("退出")])],2)],1)],1)},i=[],n=(o("4de4"),o("4160"),o("c975"),o("d81d"),o("b0c0"),o("159b"),o("ade3")),l=o("53ca"),s=o("cb41"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{ref:"ruleForm",staticStyle:{padding:"15px 20px"},attrs:{"label-width":"150px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.module.viewProps,(function(t){return o("el-col",{key:t.prop,attrs:{xs:24,sm:12}},[e.isID(t.ruleType)?e._e():o("el-form-item",{attrs:{label:t.name}},[o("div",{staticStyle:{"margin-right":"15px"}},[e._v(" "+e._s(e.dataInfo[t.prop])+" ")])])],1)})),1)],1)],1)]),e._l(this.module.children,(function(t){return o("section",{key:"_info_children_"+t.name},[o("Children",{ref:"childrenList",refInFor:!0,attrs:{parent:e.module,module:t}})],1)}))],2)},d=[],u=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-list-body",staticStyle:{"border-top":"3px solid #d2d6de","border-bottom":"1px solid #d2d6de"}},[o("div",{staticClass:"box"},[o("div",{staticClass:"left"},[o("h3",{staticStyle:{margin:"0px","padding-top":"5px"}},[e._v(e._s(e.childrenModule.showName))])]),o("div",{staticClass:"right"},[e.isModuleEditable()?o("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleChildrenUpdate()}}},[o("span",[e._v("新增")])]):e._e(),e.isModuleEditable()?o("el-button",{attrs:{type:"danger",plain:""},on:{click:function(t){return e.handleChildrenRemove()}}},[o("span",[e._v("删除")])]):e._e()],1)]),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"expand",width:"30"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form",{ref:"ruleForm",attrs:{"label-width":"150px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.childrenModule.viewProps,(function(a){return o("el-col",{key:a.prop+"_extend",attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:a.name}},[o("div",{staticStyle:{"margin-right":"15px"}},[e._v(" "+e._s(t.row[a.prop])+" ")])])],1)})),1)],1)]}}])}),o("el-table-column",{attrs:{type:"selection",width:"38"}}),e._l(e.childrenModule.viewProps,(function(t){return[e.isHideInList(t.ruleType)?e._e():o("el-table-column",{key:t.prop+"_children_column",attrs:{label:t.name,prop:t.prop},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v(" "+e._s(o.row[t.prop])+" ")]}}],null,!0)})]}))],2),o("div",{staticClass:"crud-pagination"},[o("el-pagination",{attrs:{"current-page":e.pageRequest.page,"page-sizes":[10,20,50,100],"page-size":e.pageRequest.size,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.pageRequest.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),o("el-dialog",{attrs:{visible:e.dialogResourceVisible,"append-to-body":"",top:"10vh",width:"80%",title:"授权"},on:{"update:visible":function(t){e.dialogResourceVisible=t},close:e.handleResourceClose}},[o("div",{staticStyle:{margin:"0 30px"}},[o("el-row",[o("el-col",{attrs:{xs:24,sm:12}},[o("el-form",{attrs:{"label-width":"80px","label-position":"left"}},[o("el-form-item",{attrs:{label:"菜单"}},[o("el-tree",{ref:"viewTree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.routesData,props:e.defaultProps,"show-checkbox":"","node-key":"name","default-checked-keys":e.checkedViewNames}})],1)],1)],1),o("el-col",{attrs:{xs:24,sm:12}},[o("el-form",{attrs:{"label-width":"80px","label-position":"left"}},[o("el-form-item",{attrs:{label:"操作"}},[o("el-tree",{ref:"actionTree",staticClass:"permission-tree",attrs:{"check-strictly":e.checkStrictly,data:e.actionsData,props:e.actionProps,"node-key":"name","default-checked-keys":e.checkedActionNames,"show-checkbox":""}})],1)],1)],1)],1)],1),o("div",{staticStyle:{"text-align":"center"}},[o("el-button",{attrs:{type:"danger"},on:{click:e.handleResourceSave}},[e._v("保存")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogResourceVisible=!1}}},[e._v("取消")])],1)]),o("el-dialog",{staticClass:"edit-dialog",attrs:{visible:e.dialogOtherFormVisible,"append-to-body":"","close-on-click-modal":!1,width:"80%",title:"新增"+e.childrenModule.showName},on:{"update:visible":function(t){e.dialogOtherFormVisible=t}}},[o("div",{staticClass:"edit-dialog-content"},[o("el-form",{ref:"childrenDataForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"160px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.childrenModuleProps,(function(t){return o("el-col",{key:t.prop,attrs:{xs:24,sm:"EDITOR"===t.feature?24:12}},[e.isEditableProp(t)?[o("el-form-item",{staticStyle:{"margin-right":"10%"},attrs:{label:t.name,prop:t.prop}},["STRING"===t.feature?o("el-input",{attrs:{moduleProp:t,autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"PASSWORD"===t.feature?o("el-input",{attrs:{moduleProp:t,"show-password":"",autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"NUMBER"===t.feature?o("el-input",{attrs:{type:"number",moduleProp:t,autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TEXT"===t.feature?o("FormText",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATE"===t.feature?o("FormDate",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATETIME"===t.feature?o("FormDateTime",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TIME"===t.feature?o("FormTime",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"SELECT"===t.feature?o("FormSelect",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FK"===t.feature?o("FormFK",{attrs:{moduleProp:t,showValue:e.dataForm[t.showPath],readonly:t.prop===e.refModuleProp.prop},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FILE"===t.feature||"IMAGE"===t.feature?o("FormFile",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"EDITOR"===t.feature?o("FormEditor",{attrs:{moduleProp:t},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):e._e()],1)]:e._e()],2)})),1)],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleChildrenSave}},[e._v("保存")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogOtherFormVisible=!1}}},[e._v("取消")])],1)]),o("el-dialog",{staticClass:"edit-dialog",attrs:{visible:e.dialogOtherVisible,"append-to-body":"","close-on-click-modal":!1,width:"80%",title:"新增"+e.otherModule.name},on:{"update:visible":function(t){e.dialogOtherVisible=t}}},[o("div",{staticClass:"edit-dialog-search"},[o("el-form",{attrs:{inline:!0}},[e._l(e.otherModule.filterProps,(function(t){return[o("el-form-item",{key:t.prop,attrs:{label:t.prop}},[o("FilterItem",{attrs:{filterProp:t},model:{value:t.value,callback:function(o){e.$set(t,"value",o)},expression:"filterProp.value"}})],1),o("el-form-item",{key:"search-btn_"+t.prop},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleOtherSearch}},[e._v("查询")])],1)]}))],2)],1),o("div",{staticClass:"edit-dialog-content",staticStyle:{"border-top":"3px solid #d2d6de","border-bottom":"1px solid #d2d6de"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.otherListLoading,expression:"otherListLoading"}],ref:"refOtherModuleTable",staticStyle:{width:"100%"},attrs:{data:e.otherDataList,"highlight-current-row":""},on:{"selection-change":e.handleOtherListSelectionChange}},[o("el-table-column",{attrs:{type:"expand",width:"30"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form",{ref:"ruleForm",attrs:{"label-width":"150px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.otherModule.viewProps,(function(a){return o("el-col",{key:a.prop+"_dialog",attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:a.name}},[o("div",{staticStyle:{"margin-right":"15px"}},[e._v(" "+e._s(t.row[a.prop])+" ")])])],1)})),1)],1)]}}])}),o("el-table-column",{attrs:{type:"selection",width:"38"}}),e._l(e.otherModule.viewProps,(function(t){return[e.isHideInList(t.ruleType)?e._e():o("el-table-column",{key:t.prop+"_childrenEdit_column",attrs:{label:t.name,prop:t.prop},scopedSlots:e._u([{key:"default",fn:function(o){return[e._v(" "+e._s(o.row[t.prop])+" ")]}}],null,!0)})]}))],2),o("div",{staticClass:"crud-pagination"},[o("el-pagination",{attrs:{"current-page":e.otherPageRequest.page,"page-sizes":[10,20,50,100],"page-size":e.otherPageRequest.size,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.otherPageRequest.total},on:{"size-change":e.handleOtherSizeChange,"current-change":e.handleOtherCurrentChange}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleOtherListSave}},[e._v("保存")]),o("el-button",{attrs:{type:"danger"},on:{click:e.handleOtherListRefresh}},[e._v("刷新")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogOtherVisible=!1}}},[e._v("取消")])],1)])],1)},p=[],h=(o("99af"),o("7db0"),o("b85c")),f=(o("96cf"),o("1da1")),m=o("5530"),g=o("2f62"),b=o("dbb4a"),v=o("5f32"),F=o("386d"),y=o("76e9"),k=o("c0ab"),x=o("49c8"),P=o("8f3e"),w=o("88b9"),_=o("a6ea"),S=o("1e3b"),E=o("5c96"),T=o("df7c"),O=o.n(T),C=(o("ed08"),o("a18c")),R={name:"Children",components:{FilterItem:s["a"],FormString:b["a"],FormText:v["a"],FormDate:F["a"],FormFK:w["a"],FormDateTime:k["a"],FormTime:x["a"],FormSelect:P["a"],FormFile:_["a"],FormEditor:y["a"]},props:{parent:{type:Object,default:{}},module:{type:Object,required:!0,default:{}}},data:function(){return{data:{},refModuleProp:{},rules:this.getFormRules(),dataForm:{},dataList:[],pageRequest:{page:0,size:10,total:0},loading:!1,childrenModule:{viewProps:[]},dataListSelection:[],dialogOtherFormVisible:!1,childrenModuleProps:[],dialogOtherVisible:!1,otherModule:{},otherDataList:[],otherListSelection:[],otherListLoading:!1,otherPageRequest:{page:0,size:10,total:0},dialogResourceVisible:!1,checkStrictly:!1,defaultProps:{children:"children",label:"name"},actionProps:{children:"children",label:"showName"},routes:[],checkedViewNames:[],actions:[],checkedActionNames:[],loadingOptions:{lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}}},watch:{},created:function(){this.getRoutes()},computed:Object(m["a"])(Object(m["a"])({},Object(g["b"])(["viewPermissions"])),{},{routesData:function(){return this.routes},actionsData:function(){return this.actions}}),methods:{getRoutes:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.routes=e.generateRoutes(C["a"]);case 1:case"end":return t.stop()}}),t)})))()},generateRoutes:function(e){var t,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",a=[],r=Object(h["a"])(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!i.hidden){var n=this.onlyOneShowingChild(i.children,i);i.children&&n&&!i.alwaysShow&&(i=n);var l={uri:O.a.resolve(o,i.path),name:i.meta&&i.meta.title,resourceType:"VIEW"};i.children&&(l.children=this.generateRoutes(i.children,l.path));var s=l.children||[],c=i.meta?i.meta.title:i.name;(s.length>0||this.viewPermissions[c])&&a.push(l)}}}catch(d){r.e(d)}finally{r.f()}return a},onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,o=null,a=e.filter((function(e){return!e.hidden}));return 1===a.length?(o=a[0],o.path=O.a.resolve(t.path,o.path),o):0===a.length&&(o=Object(m["a"])(Object(m["a"])({},t),{},{path:"",noShowingChildren:!0}),o)},getResources:function(){var e=this,t="resource",o=this.data[this.refModuleProp.refProp],a={roleId:o};Object(S["e"])(t,a).then((function(t){e.getRoutes(),e.routes=e.routes.concat(t.data.menuResources||[]),e.actions=t.data.actionResources,e.setCheckedViewNodes(t.data.viewResources||[],t.data.menuResources||[]),e.setCheckedActionNodes(t.data.actionResources||[]),setTimeout((function(){e.loading=!1}),200)})).catch((function(){e.loading=!1}))},setCheckedActionNodes:function(e){var t=this;this.checkedActionNames=[],e.forEach((function(e){!0===e.checked&&t.checkedActionNames.push(e.name);var o=e.children||[];o.forEach((function(e){!0===e.checked&&t.checkedActionNames.push(e.name)}))}))},setCheckedViewNodes:function(e,t){var o=this;this.checkedViewNames=[];var a=e.concat(t);a.forEach((function(e){!0===e.checked&&o.checkedViewNames.push(e.name);var t=e.children||[];t.forEach((function(e){!0===e.checked&&o.checkedViewNames.push(e.name)}))}))},handleResourceSave:function(){var e=this,t=this.$refs.viewTree.getCheckedNodes(),o=this.$refs.actionTree.getCheckedNodes(),a="resource",r=this.data[this.refModuleProp.refProp],i={_ar:JSON.stringify(o),roleId:r};i["_vr"]=JSON.stringify(t);var n=E["Loading"].service(this.loadingOptions);Object(S["c"])(a,i).then((function(t){e.getChildrenData(e.data),e.dialogResourceVisible=!1,setTimeout((function(){return n.close()}),200)})).catch((function(){n.close()}))},handleResourceClose:function(){this.$refs.viewTree.setCheckedNodes([]),this.$refs.actionTree.setCheckedNodes([])},initialize:function(e,t){this.data=e,this.refModuleProp=this.module.props.filter((function(e){return e.prop===t}))[0],this.getChildrenData(e)},isModuleEditable:function(){var e=this.parent.actions||[],t=e.filter((function(e){return"UPDATE"===e.act})).length;return t>0},getChildrenData:function(e){var t=this;if(!this.loading){e=e||this.data,this.loading=!0;var o={};o[this.refModuleProp.prop]=e[this.refModuleProp.refProp],o._page=this.pageRequest.page?this.pageRequest.page-1:0,o._size=this.pageRequest.size||10,Object(S["e"])(this.module.name,o).then((function(e){var o=e.data;t.dataList=o.content,t.pageRequest=Object.assign(o.pageable,{total:o.totalElements,page:o.number+1,size:o.size});var a=t.refModuleProp.prop,r=(t.refModuleProp.refProp,a+"."+t.refModuleProp.showProp);t.dataForm[a]=t.data[t.refModuleProp.refProp],t.dataForm[r]=t.data[t.refModuleProp.showProp],t.childrenModule=e.module,t.childrenModuleProps=e.module.props||[],setTimeout((function(){t.loading=!1}),200)})).catch((function(){t.loading=!1}))}},handleSelectionChange:function(e){this.dataListSelection=e},handleSizeChange:function(e){this.pageRequest.size=e,this.getChildrenData(this.data)},handleCurrentChange:function(e){this.pageRequest.page=e,this.getChildrenData(this.data)},handleOtherSearch:function(){this.getOtherList()},handleOtherListSelectionChange:function(e){this.otherListSelection=e},getViewFilters:function(){var e=[];return this.otherModule.name&&this.otherModule.filterProps&&this.otherModule.filterProps.forEach((function(t){var o={prop:t.prop,op:t.op?t.op:"=",value:t.value};e.push(o)})),e},getSubFilters:function(e,t,o){var a={prop:o.refProp,op:"not in",subQuery:{module:this.childrenModule.name,prop:t,filters:[{prop:e,op:"=",value:this.data[this.refModuleProp.refProp]}]}};return[a]},handleChildrenUpdate:function(){this.dialogResourceVisible=!0,this.getResources()},getFormRules:function(){var e={};return this.module.props.forEach((function(t){Object(S["t"])(t.ruleType)&&(e[t.prop]=[{required:!0,message:"必输项",trigger:"change"}])})),e},handleChildrenSave:function(){var e=this;this.$refs["childrenDataForm"].validate((function(t){if(!t)return e.$message({type:"error",message:"数据验证失败，请检查输入项"}),console.log("error submit!!"),!1;var o=e.dataForm;Object(S["c"])(e.module.name,o).then((function(t){e.dialogOtherFormVisible=!1,e.getChildrenData(e.data)})).catch((function(){}))}))},handleChildrenReset:function(){this.$refs["childrenDataForm"].resetFields()},getOtherList:function(){var e=this;if(!this.otherListLoading&&this.module.otherRefProps&&this.module.otherRefProps.length>0){this.otherListLoading=!0;var t=this.module.refProp,o={_vf:JSON.stringify(this.getViewFilters())},a=this.module.otherRefProps[0],r=this.childrenModule.props.find((function(e){return e.prop===a}));o["_sf"]=JSON.stringify(this.getSubFilters(t,a,r)),o._page=this.otherPageRequest.page?this.otherPageRequest.page-1:0,o._size=this.otherPageRequest.size||10,Object(S["e"])(r.refModuleName,o).then((function(t){var o=t.data;e.otherDataList=o.content,e.otherPageRequest=Object.assign(o.pageable,{total:o.totalElements,page:o.number+1,size:o.size});var a=e.otherModule.filterProps;e.otherModule=t.module,a&&a.length>0&&(e.otherModule.filterProps=a),setTimeout((function(){e.otherListLoading=!1}),200)})).catch((function(){e.otherListLoading=!1}))}},handleOtherListSave:function(){var e=this;if(this.otherListSelection.length<=0)this.$alert("请先勾选要保存的记录","警告",{confirmButtonText:"确认"});else{var t=this.module.refProp,o=this.module.otherRefProps[0],a=this.childrenModule.props.find((function(e){return e.prop===o})),r=[],i={module:this.childrenModule.name,data:[]};this.otherListSelection.forEach((function(r){var n={};n[t]=e.data[e.refModuleProp.refProp],n[o]=r[a.refProp],i.data.push(n)})),r.push(i);var n={_data:JSON.stringify(r)};Object(S["c"])(this.module.name,n).then((function(t){e.getChildrenData(e.data),e.dialogOtherVisible=!1})).catch((function(){}))}},handleOtherListRefresh:function(){this.getOtherList()},handleChildrenRemove:function(){var e=this;this.dataListSelection.length<=0?this.$alert("请选择待删除的记录","警告",{confirmButtonText:"确认"}):this.$confirm("确认要删除吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"警告"}).then((function(){var t={id:e.dataListSelection.map((function(t){return t[e.childrenModule.pk]}))};Object(S["x"])(e.childrenModule.name,t).then((function(t){e.getChildrenData(e.data),e.$message({type:"success",message:"删除操作执行完成"})})).catch((function(e){}))})).catch((function(){e.$message({type:"info",message:"删除已取消"})}))},getDataListSelection:function(){return this.dataListSelection},handleOtherSizeChange:function(e){this.otherPageRequest.size=e,this.getOtherList()},handleOtherCurrentChange:function(e){this.otherPageRequest.page=e,this.getOtherList()},isAuditProp:function(e){return Object(S["k"])(e)},isID:function(e){return Object(S["p"])(e)},isHideInList:function(e){return Object(S["o"])(e)},isEditableProp:function(e){var t=e.ruleType;return!Object(S["p"])(t)&&!Object(S["k"])(t)}}},D=R,$=(o("06b7"),o("94b3"),o("2877")),L=Object($["a"])(D,u,p,!1,null,"ff28d6f0",null),I=L.exports,V={name:"info",components:{Children:I},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataInfo:{},fileHttpServer:"",pageRequest:{}}},created:function(){},computed:{},methods:{initialize:function(e){this.getInfo(e),this.getChildrenData(e)},getInfo:function(e){var t=this;Object(S["h"])(this.module.name,e[this.module.pk]).then((function(e){t.dataInfo=e.data})).catch((function(){}))},deleteData:function(){var e=this;this.$confirm("确认要删除当前数据吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={};t[e.module.pk]=e.dataInfo[e.module.pk],Object(S["x"])(e.module.name,t).then((function(t){e.$emit("handleDeleteSuccess"),e.$message({type:"success",message:"删除操作执行完成"})})).catch((function(){}))})).catch((function(){e.$message({type:"info",message:"删除已取消"})}))},isID:function(e){return Object(S["p"])(e)},getChildrenData:function(e){var t=this.$refs.childrenList;t&&this.module.children.forEach((function(o,a){var r=o.refProp;t[a].initialize(e,r)}))}}},j=V,M=(o("1a23"),o("ef72"),Object($["a"])(j,c,d,!1,null,"0ea05bb2",null)),N=M.exports,z=o("60b1"),A=o("8a4f"),q={components:{FilterItem:s["a"],Info:N,Form:z["a"],Edit:A["a"]},directives:{},data:function(){return{filterProps:[],viewFilters:[],module:{name:"role"},viewProps:[],dialogViewPropertyVisible:!1,viewPropArray:[],selectedViewPropArray:[],dataListKey:0,loading:!1,dataList:[],dataListSelection:[],dataSelection:{},pageRequest:{},dialogInfoVisible:!1,dialogFormVisible:!1,dialogEditVisible:!1}},watch:{$route:function(e){},selectedViewPropArray:function(e){var t=[];this.module.viewProps.forEach((function(o){e.indexOf(o.prop)>-1&&t.push(o)})),this.viewProps=t}},created:function(){this.getList()},mounted:function(){},methods:(a={handleDrag:function(){this.$refs.select.blur()},getViewFilters:function(){var e=[];return this.filterProps.forEach((function(t){var o=t.value;Object(l["a"])(o)===Array&&(o=o[o.length-1]);var a={prop:t.prop,op:t.op||"=",value:o};e.push(a)})),e},handleSearch:function(){this.viewFilters=this.getViewFilters(),this.pageRequest.page=0,this.getList()},getList:function(){var e=this;if(!this.loading){this.loading=!0;var t={_vf:JSON.stringify(this.viewFilters)};t._page=this.pageRequest.page?this.pageRequest.page-1:0,t._size=this.pageRequest.size||10,Object(S["e"])(this.module.name,t).then((function(t){var o=t.data;e.dataList=o.content||[],e.pageRequest=Object.assign(o.pageable,{total:o.totalElements,page:o.number+1,size:o.size}),e.module=Object.assign(e.module,t.module),0===e.filterProps.length&&(e.filterProps=e.module.filterProps),0===e.viewProps.length&&e.module.viewProps.filter((function(e){return!Object(S["o"])(e.ruleType)})).forEach((function(t){e.viewProps.push(t),e.viewPropArray.push(t.prop)})),setTimeout((function(){e.loading=!1}),200)})).catch((function(){e.loading=!1}))}},handleSelectionChange:function(e){this.dataListSelection=e},handleCreate:function(){this.dialogFormVisible=!0},openFormDialog:function(){this.$nextTick((function(e){}))},handleFormSave:function(){this.$refs["dialogForm"].submitForm()},handleFormReset:function(){this.$refs["dialogForm"].initialize()},handleCreateSuccess:function(){this.getList(),this.dialogFormVisible=!1},handleUpdateRow:function(e,t){this.dataSelection=e,this.dialogEditVisible=!0},handleUpdate:function(e){this.dataListSelection.length<=0?this.$alert("请选择一行待修改的记录","警告",{confirmButtonText:"确认"}):(this.dataSelection=this.dataListSelection[0],this.dialogEditVisible=!0)},openEditDialog:function(){var e=this;this.$nextTick((function(t){e.$refs.dialogEdit.initialize(e.dataSelection)}))},handleEditSave:function(){this.$refs["dialogEdit"].submitForm()},handleEditDelete:function(){this.$refs["dialogEdit"].deleteData()},handleEditRefresh:function(){this.$refs.dialogEdit.initialize(this.dataSelection)},handleEditUpdateSuccess:function(){this.dialogEditVisible=!1,this.getList()},handleEditDeleteSuccess:function(){this.dialogEditVisible=!1,this.getList()},handleInfo:function(e){this.dialogInfoVisible=!0,this.dataSelection=e},openInfoDialog:function(){var e=this;this.$nextTick((function(t){e.$refs.dialogInfo.initialize(e.dataSelection)}))},handleInfoRefresh:function(){this.$refs.dialogInfo.initialize(this.dataSelection)},handleInfoUpdate:function(){this.dialogInfoVisible=!1,this.handleUpdateRow(this.dataSelection)},handleInfoDelete:function(){this.$refs.dialogInfo.deleteData()},handleInfoDeleteSuccess:function(){this.dialogInfoVisible=!1,this.getList()},handleDeleteRow:function(e,t){var o=this;this.$confirm("确认要删除当前记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};Object(S["x"])(o.module.name,t).then((function(e){o.getList(),o.$message({type:"success",message:"删除操作执行完成"})})).catch((function(e){}))})).catch((function(){o.$message({type:"info",message:"删除已取消"})}))},handleDelete:function(e){var t=this;this.dataListSelection.length<=0?this.$alert("请选择待删除的记录","警告",{confirmButtonText:"确认"}):this.$confirm("确认要删除吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var e={id:t.dataListSelection.map((function(e){return e[t.module.pk]}))};Object(S["x"])(t.module.name,e).then((function(e){t.getList(),t.$message({type:"success",message:"删除操作执行完成"})})).catch((function(e){}))})).catch((function(){t.$message({type:"info",message:"删除已取消"})}))},isAuditProp:function(e){return Object(S["k"])(e)},isID:function(e){return Object(S["p"])(e)},isHideInList:function(e){return Object(S["o"])(e)}},Object(n["a"])(a,"handleSelectionChange",(function(e){this.dataListSelection=e})),Object(n["a"])(a,"handleSizeChange",(function(e){this.pageRequest.size=e,this.getList(),console.log("每页 ".concat(e," 条"))})),Object(n["a"])(a,"handleCurrentChange",(function(e){this.pageRequest.page=e,this.getList(),console.log("当前页: ".concat(e))})),Object(n["a"])(a,"handleDialogDrag",(function(){this.$refs.select.blur()})),a)},U=q,B=(o("1bcb"),o("d0c7"),Object($["a"])(U,r,i,!1,null,"dc33d1c4",null));t["default"]=B.exports},"8a4f":function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{key:e.dataFormKey,ref:"ruleForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"160px"}},[o("el-row",{attrs:{gutter:0}},e._l(e.moduleProps,(function(t){return o("el-col",{key:t.prop,staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:e.isShowInRow(t)?24:12}},[e.isHideInEdit(t.ruleType)?e._e():[o("el-form-item",{attrs:{label:t.name,prop:t.prop}},["PASSWORD"===t.feature?o("el-input",{attrs:{type:"password",moduleProp:t,disabled:e.isNoUpdate(t.ruleType),autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"NUMBER"===t.feature?o("el-input",{attrs:{type:"number",moduleProp:t,disabled:e.isNoUpdate(t.ruleType),autocomplete:"off"},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TEXT"===t.feature?o("FormText",{attrs:{moduleProp:t,readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATE"===t.feature?o("FormDate",{attrs:{moduleProp:t,readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"DATETIME"===t.feature?o("FormDateTime",{attrs:{moduleProp:t,readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"TIME"===t.feature?o("FormTime",{attrs:{moduleProp:t,readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"SELECT"===t.feature?o("FormSelect",{attrs:{moduleProp:t,showValue:e.dataForm[t.prop],readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FK"===t.feature?o("FormFK",{attrs:{moduleProp:t,showValue:e.dataForm[t.showPath],readonly:e.isNoUpdate(t.ruleType)},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var r=t[a];e.$set(e.dataForm,r,o[a])}))}},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"FILE"===t.feature||"IMAGE"===t.feature?o("FormFile",{attrs:{moduleProp:t,showUri:e.dataForm[t.prop],readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):"EDITOR"===t.feature?o("FormEditor",{attrs:{moduleProp:t,readonly:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}}):o("el-input",{attrs:{moduleProp:t,autocomplete:"off",disabled:e.isNoUpdate(t.ruleType)},model:{value:e.dataForm[t.prop],callback:function(o){e.$set(e.dataForm,t.prop,o)},expression:"dataForm[prop.prop]"}})],1)]],2)})),1)],1)],1)]),e._l(e.children,(function(e){return o("section",{key:"_edit_children_"+e.name},[o("Children",{ref:"childrenList",refInFor:!0,attrs:{module:e}})],1)}))],2)},r=[],i=(o("4de4"),o("7db0"),o("4160"),o("b0c0"),o("d3b7"),o("159b"),o("ddb0"),o("5530")),n=o("dbb4a"),l=o("5f32"),s=o("386d"),c=o("76e9"),d=o("c0ab"),u=o("49c8"),p=o("8f3e"),h=o("88b9"),f=o("a6ea"),m=o("5876"),g=o("2f62"),b=o("1e3b"),v={name:"Edit",components:{FormString:n["a"],FormText:l["a"],FormDate:s["a"],FormFK:h["a"],FormDateTime:d["a"],FormTime:u["a"],FormSelect:p["a"],FormFile:f["a"],FormEditor:c["a"],Children:m["a"]},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataFormKey:0,dataForm:{},moduleProps:this.module.props||[],rules:this.getFormRules(),pk:this.module.pk,children:this.getChildren()||[],action:{}}},created:function(){},computed:Object(i["a"])({},Object(g["b"])(["permission"])),methods:{initialize:function(e){this.getInfo(e),this.getChildrenData(e)},setAction:function(e){var t=this;this.action=e||{};var o=[];!this.action.props||this.action.props.length<=0?o=this.module.props:this.moduleProps.forEach((function(e){var a=t.action.props.find((function(t){return e.prop===t.prop}));if(a){var r=Object(i["a"])({},e);r.defaultValue=a.value,r.values=a.values,r.ruleType|=a.ruleType,o.push(r)}})),this.rules=this.getFormRules(o),this.moduleProps=o},getFormRules:function(e){var t={},o=e||this.moduleProps||[];return o.forEach((function(e){Object(b["t"])(e.ruleType)&&(t[e.prop]=[{required:!0,message:"必输项",trigger:"blur"}])})),this.dataFormKey++,t},submitForm:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return e.$message({type:"error",message:"数据验证失败，请检查输入项"}),console.log("error submit!!"),!1;var o={};e.moduleProps.forEach((function(t){e.isHideInEdit(t.ruleType)&&!e.isID(t.ruleType)||(o[t.prop]=e.dataForm[t.prop])})),Object(b["z"])(e.module.name,o).then((function(t){e.$emit("handleUpdateSuccess")})).catch((function(){}))}))},isHideInEdit:function(e){return Object(b["l"])(e)},getInfo:function(e){var t=this;Object(b["h"])(this.module.name,e[this.module.pk]).then((function(e){t.dataForm=e.data})).catch((function(){}))},getChildren:function(){var e=this,t=this.module.children||[];return t=t.filter((function(t){var o=t.props||[],a=o.filter((function(t){return!t.refModuleName&&!e.isHideInEdit(t.prop)})).length;return!(a>1)&&(t.otherRefProps&&1==t.otherRefProps.length)})),t},getChildrenData:function(e){var t=this.$refs.childrenList;t&&this.children.forEach((function(o,a){var r=o.refProp;t[a].initialize(e,r)}))},deleteData:function(){var e=this;this.$confirm("确认要删除当前数据吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={};t[e.module.pk]=e.dataForm[e.module.pk],Object(b["x"])(e.module.name,t).then((function(t){e.$emit("handleDeleteSuccess"),e.$message({type:"success",message:"删除操作执行完成"})})).catch((function(){}))})).catch((function(t){e.$message({type:"info",message:"删除已取消"})}))},isNoUpdate:b["s"],isShowInRow:b["u"],isID:b["p"]}},F=v,y=(o("3b79"),o("2877")),k=Object(y["a"])(F,a,r,!1,null,"a03c7a02",null);t["a"]=k.exports},"94b3":function(e,t,o){"use strict";var a=o("afca"),r=o.n(a);r.a},afca:function(e,t,o){},b9a8:function(e,t,o){},bfd7:function(e,t,o){},ce3c:function(e,t,o){},d0c7:function(e,t,o){"use strict";var a=o("22c9"),r=o.n(a);r.a},d630:function(e,t,o){},ef72:function(e,t,o){"use strict";var a=o("b9a8"),r=o.n(a);r.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a8ca338"],{"076b":function(e,t,o){"use strict";var a=o("b4d8"),i=o.n(a);i.a},"0c7e":function(e,t,o){"use strict";var a=o("a415"),i=o.n(a);i.a},1:function(e,t){},"127f":function(e,t,o){},"15a9":function(e,t,o){"use strict";var a=o("6d95"),i=o.n(a);i.a},2:function(e,t){},3:function(e,t){},4270:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-import-dialog"},[o("el-dialog",{attrs:{visible:e.dialogImportVisible,width:"80%","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogImportVisible=t}}},[o("div",{attrs:{slot:"title"},slot:"title"},[e._v("上传导入"+e._s(e.module.showName))]),o("upload-excel-component",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.previewLoading,expression:"previewLoading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.tableData,border:"","highlight-current-row":""}},e._l(e.tableHeader,(function(e){return o("el-table-column",{key:e,attrs:{prop:e,label:e}})})),1),o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",plain:"",disabled:e.downloadLoading},on:{click:e.handleTemplate}},[e._v("下载模板")]),o("el-button",{attrs:{type:"primary",loading:e.saveLoading,disabled:e.tableData.length<=0},on:{click:e.handleCreate}},[e._v("保存")]),o("el-button",{attrs:{type:"danger"},on:{click:e.handleReset}},[e._v("重置")]),o("el-button",{on:{click:function(t){e.dialogImportVisible=!1}}},[e._v("取消")])],1)],1)],1)},i=[],r=(o("99af"),o("4de4"),o("d81d"),o("b0c0"),o("d3b7"),o("3796")),l=o("1e3b"),s={name:"ImportList",components:{UploadExcelComponent:r["a"]},props:{module:{type:Object,default:{}}},data:function(){return{dialogImportVisible:!1,tableData:[],tableHeader:[],downloadLoading:!1,previewLoading:!1,saveLoading:!1}},created:function(){},methods:{handleDialogDrag:function(){this.$refs.select.blur()},handleTemplate:function(){var e=this;this.downloadLoading=!0;var t=this.module.name+"_template",a=this.module.props.filter((function(e){return Object(l["q"])(e.ruleType)})).map((function(e){return e.prop}));Promise.all([o.e("chunk-5b0190f0"),o.e("chunk-09290bef")]).then(o.bind(null,"4bf8")).then((function(o){o.export_json_to_excel({header:a,data:[],filename:t,autoWidth:!0,bookType:"xlsx"}),e.downloadLoading=!1}))},beforeUpload:function(e){var t=e.size/1024/1024<5;return!!t||(this.$message({message:"上传文件大小不能超过5M，请修改后重新上传",type:"warning"}),!1)},handleSuccess:function(e){var t=this,o=e.results,a=e.header;if(!this.previewLoading){var i=JSON.stringify(a),r=JSON.stringify(o);this.previewLoading=!0;var s={_props:i,_data:r};Object(l["w"])(this.module.name,s).then((function(e){t.tableHeader=a.concat(["_check"]),t.tableData=e.data,setTimeout((function(){t.previewLoading=!1}),200)})).catch((function(e){t.previewLoading=!1}))}},handleCreate:function(){var e=this;this.saveLoading=!0;var t={_data:JSON.stringify(this.tableData)};Object(l["y"])(this.module.name,t).then((function(t){e.saveLoading=!1,e.$message({type:"success",message:"数据已经保存完成！"}),e.dialogImportVisible=!1,e.$emit("import"),e.tableData=[],e.tableHeader=[],setTimeout((function(){return e.saveLoading=!1}),200)})).catch((function(t){e.saveLoading=!1}))},handleReset:function(){this.tableData=[],this.tableHeader=[]}}},n=s,c=(o("7071"),o("2877")),d=Object(c["a"])(n,a,i,!1,null,"7661c810",null);t["a"]=d.exports},"488d":function(e,t,o){},"5b58":function(e,t,o){"use strict";o.r(t);var a,i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-list-container"},[o("div",{staticStyle:{padding:"15px 15px 5px 15px"}},[o("div",{staticStyle:{margin:"0 10px",position:"relative"}},[o("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[o("el-tab-pane",{attrs:{label:"全部商品",name:"ALL"}}),o("el-tab-pane",{attrs:{label:"出售中",name:"ON_SALE"}}),o("el-tab-pane",{attrs:{label:"已售完",name:"SALE_OUT"}}),o("el-tab-pane",{attrs:{label:"已下架",name:"OFF_SALE"}})],1),o("div",{staticStyle:{position:"absolute",right:"0px",top:"0px"}},[o("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSort("sellVolume")}}},[e._v("按销量排序")]),o("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSort("retailPrice")}}},[e._v("按售价排序")]),o("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.handleSort("goodsNumber")}}},[e._v("按库存排序")])],1)],1),o("el-form",{attrs:{inline:!0}},[e._l(e.filterProps||[],(function(t,a){return[o("el-form-item",{key:"home-filter-"+t.prop+"_"+a,staticStyle:{"text-align":"right"},attrs:{label:t.name,"label-width":"88px"}},[o("FilterItem",{attrs:{filterProp:t},on:{handleOp:function(o){e.$set(t,"op",o)}},model:{value:t.value,callback:function(o){e.$set(t,"value",o)},expression:"filterProp.value"}})],1)]})),o("el-form-item",{key:"home-search-btn"},[o("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleSearch}},[e._v("查询")])],1)],2)],1),o("div",{staticClass:"example-list-body",staticStyle:{margin:"0px 20px 20px 20px","border-top":"3px solid #d2d6de","border-bottom":"1px solid #d2d6de"}},[o("div",{staticClass:"box"},[o("div",{staticClass:"left"},[e._l(e.module.actions||[],(function(t){return["CREATE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default",icon:"el-icon-edit-outline"},on:{click:function(o){return e.handleCreate(t)}}},[o("span",[e._v(e._s(t.name))])]):"UPDATE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default",icon:"el-icon-edit"},on:{click:function(o){return e.handleUpdate(t)}}},[o("span",[e._v(e._s(t.name))])]):"DELETE"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default",icon:"el-icon-delete"},on:{click:function(o){return e.handleDelete(t)}}},[o("span",[e._v(e._s(t.name))])]):"IMPORT"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default",icon:"el-icon-upload2"},on:{click:e.handleImport}},[o("span",[e._v(e._s(t.name))])]):"EXPORT"===t.act?o("el-button",{key:"tool_action_"+t.id,attrs:{type:"default",icon:"el-icon-download"},on:{click:e.handleExport}},[o("span",[e._v(e._s(t.name))])]):e._e()]}))],2),o("div",{staticClass:"right"},[o("el-button",{attrs:{type:"default",icon:"el-icon-refresh"},on:{click:e.getList}}),o("el-button",{attrs:{type:"default",icon:"el-icon-menu"},on:{click:function(t){e.dialogViewPropertyVisible=!0}}})],1)]),o("section",{staticClass:"table-list"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.dataListKey,staticStyle:{width:"100%"},attrs:{data:e.dataList,"highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"expand",width:"30"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form",{ref:"ruleForm",staticStyle:{"max-width":"1264px"},attrs:{"label-width":"120px"}},[o("el-row",{attrs:{gutter:0}},[e._l(e.module.viewProps,(function(a){return[e.isHideInInfo(a.ruleType)||e.isAuditProp(a.ruleType)?e._e():o("el-col",{key:a.prop+"_expand",attrs:{xs:24,sm:e.isShowInRow(a)?24:12}},[o("el-form-item",{attrs:{label:a.name}},["IMAGE"===a.feature&&t.row[a.prop]?o("div",[o("a",{attrs:{href:"#"},on:{click:function(o){e.handlePreview(e.getFileUrl(t.row[a.prop],a.ruleType))}}},[o("img",{staticClass:"max_20_20",attrs:{src:e.getFileUrl(t.row[a.prop],a.ruleType)}})])]):"FILE"===a.feature&&t.row[a.prop]?o("div",[o("a",{attrs:{href:e.getFileUrl(t.row[a.prop],a.ruleType),target:"_blank"}},[o("i",{staticClass:"el-icon-document"})])]):"EDITOR"===a.feature&&t.row[a.prop]?o("div",[o("div",{domProps:{innerHTML:e._s(t.row[a.prop])}})]):o("div",[e._v(e._s(t.row[a.prop]))])])],1)]}))],2)],1)]}}])}),o("el-table-column",{staticStyle:{padding:"0px!important"},attrs:{type:"selection",width:"38"}}),o("el-table-column",{attrs:{label:"操作",width:"78"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{padding:"4px","margin-right":"4px"},attrs:{type:"default",icon:"el-icon-document",title:"详情"},on:{click:function(o){return e.handleInfo(t.row)}}}),e.module.actions?o("el-dropdown",{attrs:{placement:"bottom",trigger:"click","hide-on-click":!1}},[o("el-button",{staticStyle:{padding:"4px"},attrs:{type:"default",icon:"el-icon-arrow-right",title:"更多"}}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e._l(e.module.actions,(function(a){return["UPDATE"===a.act?o("el-dropdown-item",{key:"list_update_"+a.name,staticStyle:{"min-width":"100px"},attrs:{disabled:a.disableProp&&a.disableValues.find((function(e){return e===t.row[a.disableProp]}))},nativeOn:{click:function(o){return e.handleUpdateRow(t.row,a)}}},[o("i",{staticClass:"el-icon-edit"}),e._v(" "+e._s(a.name)+" ")]):"DELETE"===a.act?o("el-dropdown-item",{key:"list_delete_"+a.name,attrs:{disabled:a.disableProp&&a.disableValues.find((function(e){return e===t.row[a.disableProp]}))},nativeOn:{click:function(o){return e.handleDeleteRow(t.row,a)}}},[o("i",{staticClass:"el-icon-delete"}),e._v(" "+e._s(a.name)+" ")]):!a.act&&a.uri?o("el-dropdown-item",{key:"list_execute_"+a.name,attrs:{disabled:a.disableProp&&a.disableValues.find((function(e){return e===t.row[a.disableProp]}))},nativeOn:{click:function(o){return e.handleExecuteRow(t.row,a)}}},[o("i",{staticClass:"el-icon-video-play"}),e._v(" "+e._s(a.name)+" ")]):e._e()]}))],2)],1):e._e()]}}])}),e._l(e.viewProps,(function(t){return[e.isHideInList(t.ruleType)?e._e():o("el-table-column",{key:t.prop,attrs:{label:t.name,prop:t.prop,"min-width":e.columnMinWidth(t.maxLength),sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return["IMAGE"===t.feature&&a.row[t.prop]?o("div",[o("a",{attrs:{href:"#"},on:{click:function(o){e.handlePreview(e.getFileUrl(a.row[t.prop],t.ruleType))}}},[o("img",{staticClass:"max_20_20",attrs:{src:e.getFileUrl(a.row[t.prop],t.ruleType)}})])]):"FILE"===t.feature&&a.row[t.prop]?o("div",[o("a",{attrs:{href:e.getFileUrl(a.row[t.prop],t.ruleType),target:"_blank"}},[o("i",{staticClass:"el-icon-document"})])]):o("div",[e._v(e._s(a.row[t.prop]))])]}}],null,!0)})]}))],2),o("div",{staticClass:"crud-pagination"},[o("el-pagination",{attrs:{"current-page":e.pageRequest.page,"page-sizes":[10,20,50,100,1e3],"page-size":e.pageRequest.size,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.pageRequest.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),o("el-dialog",{attrs:{visible:e.dialogViewPropertyVisible,left:"","close-on-click-modal":!0},on:{"update:visible":function(t){e.dialogViewPropertyVisible=t}}},[o("div",{attrs:{slot:"title"},slot:"title"},[e._v("选择可显示列")]),o("div",{staticStyle:{"margin-top":"-25px"}},[o("div",{staticStyle:{padding:"0px",margin:"0px"}},[o("div",{staticStyle:{"margin-top":"0px",padding:"20px 15px","border-top":"1px solid #d2d6de","line-height":"28px"}},[o("el-checkbox-group",{model:{value:e.viewPropArray,callback:function(t){e.viewPropArray=t},expression:"viewPropArray"}},[o("el-row",[e._l(e.module.viewProps,(function(t,a){return[e.isListProp(t.ruleType)?o("el-col",{key:"dialog_"+t.prop+a,attrs:{xs:12,sm:8}},[o("el-checkbox",{attrs:{label:t.prop}},[e._v(e._s(t.name))])],1):e._e()]}))],2)],1)],1),o("div",{staticStyle:{"text-align":"center","margin-top":"0px","border-top":"1px solid #f2f2f2",padding:"10px 10px 0px 10px","margin-bottom":"-15px"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectedViewPropArray=e.viewPropArray,e.dialogViewPropertyVisible=!1}}},[e._v("确定")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogViewPropertyVisible=!1}}},[e._v("取消")])],1)])])]),o("el-dialog",{attrs:{visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"86%",title:"新建"+e.module.showName},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.openFormDialog}},[o("Form",{ref:"dialogForm",attrs:{module:e.module},on:{handleSuccess:e.handleCreateSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleFormSave}},[e._v("保存")]),o("el-button",{attrs:{type:"danger"},on:{click:e.handleFormReset}},[e._v("重置")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])],1)],1),o("el-dialog",{attrs:{visible:e.dialogEditVisible,"close-on-click-modal":!1,fullscreen:e.fullscreen,width:"86%",title:"修改"+e.module.showName},on:{"update:visible":function(t){e.dialogEditVisible=t},open:e.openEditDialog}},[o("Edit",{ref:"dialogEdit",attrs:{module:e.module},on:{handleUpdateSuccess:e.handleEditUpdateSuccess,handleDeleteSuccess:e.handleEditDeleteSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleEditSave}},[e._v("保存")]),e._l(e.module.actions||[],(function(t){return["DELETE"===t.act?o("el-button",{key:"edit_footer_act_"+t.id,attrs:{type:"danger"},on:{click:e.handleEditDelete}},[e._v(" "+e._s(t.name)+" ")]):e._e()]})),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogEditVisible=!1}}},[e._v("取消")])],2)],1),o("el-dialog",{attrs:{visible:e.dialogInfoVisible,"close-on-click-modal":!1,width:"86%",title:e.module.showName+"详情"},on:{"update:visible":function(t){e.dialogInfoVisible=t},open:e.openInfoDialog}},[o("Info",{ref:"dialogInfo",attrs:{module:e.module},on:{handleDeleteSuccess:e.handleInfoDeleteSuccess}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e._l(e.module.actions||[],(function(t){return["UPDATE"===t.act?o("el-button",{key:"info_footer_act_"+t.id,attrs:{type:"danger",disabled:t.disableProp&&t.disableValues.find((function(o){return o===e.dataSelection[t.disableProp]}))},on:{click:e.handleInfoUpdate}},[e._v(" "+e._s(t.name)+" ")]):e._e(),"DELETE"===t.act?o("el-button",{key:"info_footer_act_"+t.id,attrs:{type:"danger",disabled:t.disableProp&&t.disableValues.find((function(o){return o===e.dataSelection[t.disableProp]}))},on:{click:e.handleInfoDelete}},[e._v(" "+e._s(t.name)+" ")]):e._e()]})),o("el-button",{attrs:{type:"danger"},on:{click:e.handleInfoRefresh}},[e._v("刷新")]),o("el-button",{attrs:{type:"success"},on:{click:function(t){e.dialogInfoVisible=!1}}},[e._v("退出")])],2)],1),o("import-list",{ref:"importList",attrs:{module:e.module},on:{import:e.handleImportComplete}}),o("export-list",{ref:"exportList",attrs:{module:e.module,selectedPropArray:e.viewPropArray,dataList:e.dataList,dataListSelection:e.dataListSelection}})],1)},r=[],l=(o("4de4"),o("7db0"),o("4160"),o("c975"),o("d81d"),o("b0c0"),o("ac1f"),o("8a79"),o("1276"),o("159b"),o("ade3")),s=o("53ca"),n=o("5530"),c=o("2f62"),d=(o("5c96"),o("3e10")),u=o("cb41"),p=o("b10d"),m=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{key:e.dataFormKey,ref:"ruleForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"160px"}},[o("el-row",{attrs:{gutter:0}},[o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品分类",prop:"category"}},[o("FormFK",{attrs:{moduleProp:{prop:"category",refProp:"id",refModuleName:"category",showProp:"name",showPath:"category.name"},showValue:e.dataForm["category.name"]},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var i=t[a];e.$set(e.dataForm,i,o[a])}))}},model:{value:e.dataForm["category"],callback:function(t){e.$set(e.dataForm,"category",t)},expression:"dataForm['category']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品图片",prop:"listPicUrl"}},[o("FormFile",{attrs:{moduleProp:{prop:"listPicUrl",feature:"IMAGE",ruleType:1024},showUri:e.dataForm["listPicUrl"]},model:{value:e.dataForm["listPicUrl"],callback:function(t){e.$set(e.dataForm,"listPicUrl",t)},expression:"dataForm['listPicUrl']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品轮播图",prop:"galleryImgs"}},[o("FormFile",{ref:"galleryImgs",attrs:{moduleProp:{prop:"galleryImgs",feature:"IMAGE",ruleType:1024},limitSize:10,showUri:e.dataForm.galleryImgs||""},model:{value:e.dataForm.galleryImgs,callback:function(t){e.$set(e.dataForm,"galleryImgs",t)},expression:"dataForm.galleryImgs"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["name"],callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm['name']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品简介",prop:"goodsBrief"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["goodsBrief"],callback:function(t){e.$set(e.dataForm,"goodsBrief",t)},expression:"dataForm['goodsBrief']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"商品单位",prop:"goodsUnit"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["goodsUnit"],callback:function(t){e.$set(e.dataForm,"goodsUnit",t)},expression:"dataForm['goodsUnit']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"销量",prop:"sellVolume"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["sellVolume"],callback:function(t){e.$set(e.dataForm,"sellVolume",t)},expression:"dataForm['sellVolume']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"型号和价格",prop:"specificationId1"}},[o("el-select",{ref:"select",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dataForm.specificationId1,callback:function(t){e.$set(e.dataForm,"specificationId1",t)},expression:"dataForm.specificationId1"}},e._l(e.specificationList,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1),o("div",{staticStyle:{"margin-top":"10px"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.productList}},[o("el-table-column",{attrs:{label:"商品SKU"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},on:{blur:function(o){return e.checkSkuOnly(t.$index,t.row)}},model:{value:t.row.goodsSn,callback:function(o){e.$set(t.row,"goodsSn",o)},expression:"scope.row.goodsSn"}})]}}])}),o("el-table-column",{attrs:{label:"快递单上的简称",width:180},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsName,callback:function(o){e.$set(t.row,"goodsName",o)},expression:"scope.row.goodsName"}})]}}])}),o("el-table-column",{attrs:{label:"型号/规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value",o)},expression:"scope.row.value"}})]}}])}),o("el-table-column",{attrs:{label:"成本（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.cost,callback:function(o){e.$set(t.row,"cost",o)},expression:"scope.row.cost"}})]}}])}),o("el-table-column",{attrs:{label:"零售（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.retailPrice,callback:function(o){e.$set(t.row,"retailPrice",o)},expression:"scope.row.retailPrice"}})]}}])}),o("el-table-column",{attrs:{label:"重量（KG）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsWeight,callback:function(o){e.$set(t.row,"goodsWeight",o)},expression:"scope.row.goodsWeight"}})]}}])}),o("el-table-column",{attrs:{label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsNumber,callback:function(o){e.$set(t.row,"goodsNumber",o)},expression:"scope.row.goodsNumber"}})]}}])}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){return e.handleDelProduct(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleAddProduct}},[e._v("新增型号")])],1)],1)],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"选择快递模板",prop:"freightTemplate"}},[o("FormFK",{attrs:{moduleProp:{prop:"freightTemplate",refProp:"id",refModuleName:"freightTemplate",showProp:"name",showPath:"freightTemplate.name"},showValue:e.dataForm["freightTemplate.name"]},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var i=t[a];e.$set(e.dataForm,i,o[a])}))}},model:{value:e.dataForm["freightTemplate"],callback:function(t){e.$set(e.dataForm,"freightTemplate",t)},expression:"dataForm['freightTemplate']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"排序",prop:"sortOrder"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["sortOrder"],callback:function(t){e.$set(e.dataForm,"sortOrder",t)},expression:"dataForm['sortOrder']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"首页显示",prop:"isIndex"}},[o("FormSelect",{attrs:{moduleProp:{prop:"isIndex",values:[{label:"是",value:!0},{label:"否",value:!1}]},showValue:e.dataForm["isIndex"]},model:{value:e.dataForm["isIndex"],callback:function(t){e.$set(e.dataForm,"isIndex",t)},expression:"dataForm['isIndex']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"发布",prop:"isOnSale"}},[o("el-switch",{attrs:{"active-text":"上架","inactive-text":"下架"},model:{value:e.dataForm["isOnSale"],callback:function(t){e.$set(e.dataForm,"isOnSale",t)},expression:"dataForm['isOnSale']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品详情",prop:"goodsDesc"}},[o("FormEditor",{attrs:{moduleProp:{}},model:{value:e.dataForm["goodsDesc"],callback:function(t){e.$set(e.dataForm,"goodsDesc",t)},expression:"dataForm['goodsDesc']"}})],1)],1)],1)],1)],1)]),e._l(e.childrenModules,(function(e){return o("section",{key:"children_section_"+e.name},[o("Children",{ref:"childrenList",refInFor:!0,attrs:{module:e}})],1)}))],2)},f=[],h=(o("a434"),o("d3b7"),o("ddb0"),o("b85c")),g=o("dbb4a"),b=o("5f32"),v=o("386d"),y=o("76e9"),x=o("c0ab"),F=o("49c8"),w=o("8f3e"),S=o("88b9"),k=o("a6ea"),_=o("9670"),I=o("1e3b"),P={name:"froms",components:{FormString:g["a"],FormText:b["a"],FormDate:v["a"],FormFK:S["a"],FormDateTime:x["a"],FormTime:F["a"],FormSelect:w["a"],FormFile:k["a"],FormEditor:y["a"],Children:_["a"]},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataFormKey:0,dataForm:{},rules:this.getFormRules(),pk:this.module.pk,moduleProps:this.module.props||[],children:this.getChildren()||[],childrenModules:[],action:{},specificationList:[],productList:[]}},created:function(){this.getChildrenModules(),this.initialize()},mounted:function(){},computed:Object(n["a"])({},Object(c["b"])(["permission"])),methods:{initialize:function(){var e=this;this.dataForm={},this.module.props.filter((function(e){return!!e.defaultValue})).forEach((function(t){e.dataForm[t.prop]=t.defaultValue||""})),this.$nextTick((function(t){e.$refs.childrenList&&e.$refs.childrenList.forEach((function(e){return e.getChildrenData()}))})),this.getSpecificationList()},setAction:function(e){var t=this;if(this.dataForm={},this.action=e||{},!this.action.props||this.action.props.length<=0)this.moduleProps=this.module.props;else{var o=[];this.moduleProps.forEach((function(e){var a=t.action.props.find((function(t){return e.prop===t.prop}));if(a){var i=Object(n["a"])({},e);i.defaultValue=a.value,i.values=a.values,i.ruleType|=a.ruleType,o.push(i)}})),this.moduleProps=o}this.moduleProps.filter((function(e){return!!e.defaultValue})).forEach((function(e){t.dataForm[e.prop]=e.defaultValue||""})),this.rules=this.getFormRules()},getFormRules:function(){var e={category:[{required:!0,message:"必输项",trigger:"blur"}],listPicUrl:[{required:!0,message:"必输项",trigger:"blur"}],galleryImgs:[{required:!0,message:"必输项",trigger:"blur"}],name:[{required:!0,message:"必输项",trigger:"blur"}],goodsBrief:[{required:!0,message:"必输项",trigger:"blur"}],goodsUnit:[{required:!0,message:"必输项",trigger:"blur"}],sellVolume:[{required:!0,message:"必输项",trigger:"blur"}],specificationId:[{required:!0,message:"必输项",trigger:"blur"}],freightTemplate:[{required:!0,message:"必输项",trigger:"blur"}]};return this.dataFormKey++,e},submitForm:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return e.$message({type:"error",message:"数据验证失败，请检查输入项"}),console.log("error submit!!"),!1;if(!e.productList||e.productList.length<=0)return e.$message({type:"error",message:"型号和价格的值不能为空"}),!1;var o,a=Object(h["a"])(e.productList);try{for(a.s();!(o=a.n()).done;){var i=o.value;if(!i.cost||!i.goodsSn||!i.goodsName||!i.goodsWeight||!i.retailPrice||!i.value||!i.goodsNumber)return e.$message({type:"error",message:"型号和价格的值不能为空"}),!1}}catch(s){a.e(s)}finally{a.f()}var r=e.getActionDataList(),l={_data:JSON.stringify(r)};l._action=e.action.id,l.specificationId1=e.dataForm.specificationId1,l.galleryImgs=e.dataForm.galleryImgs,e.productList.forEach((function(e){e.isDelete=!1,e.isOnSale=!0,e.hasChange=!1})),l.productList=JSON.stringify(e.productList),Object(I["c"])(e.module.name,l).then((function(t){e.initialize(),e.$emit("handleSuccess")})).catch((function(){}))}))},isHideInForm:function(e){return Object(I["m"])(e)},getSpecificationList:function(){var e=this;Object(I["e"])("specification",{_sort:"sortOrder",_direction:"asc"}).then((function(t){e.specificationList=t.data.content})).catch((function(){}))},checkSkuOnly:function(e,t){var o=this;if(console.log(e),""===t.goodsSn)return this.$message({type:"error",message:"SKU不能为空"}),!1;Object(I["e"])("product",{goodsSn:t.goodsSn}).then((function(e){e.data.content.length>0?e.data.content[0].id!==t.id&&o.$message({type:"error",message:"该SKU已存在！"}):o.$message({type:"success",message:"该SKU可以用！"})})).catch((function(){}))},getChildren:function(){var e=this,t=this.module.children||[];return t=t.filter((function(t){var o=t.props||[],a=o.filter((function(t){return!t.refModuleName&&!e.isHideInForm(t.prop)})).length;return!(a>1)&&(t.otherRefProps&&1==t.otherRefProps.length)})),t},getChildrenModules:function(){var e=this;this.children.forEach((function(t){t.otherRefProps.forEach((function(o){var a=t.props.filter((function(e){return e.prop===o}))[0],i=a.refProp,r=a.refModuleName;e.childrenModules.push({name:r,pk:i})}))}))},getActionDataList:function(){var e=this,t=[{module:this.module.name,data:this.dataForm}],o=this.$refs.childrenList;return this.children.forEach((function(a,i){var r={module:a.name},l=e.childrenModules[i].pk,s=a.otherRefProps[0],n=[],c=o[i].dataListSelection;c.forEach((function(e){var t={};t[s]=e[l],n.push(t)})),r.data=n,t.push(r)})),t},handleDelProduct:function(e,t){this.productList.splice(e,1)},handleAddProduct:function(){this.productList.push({})},isShowInRow:I["u"]}},L=P,E=(o("f8f1"),o("2877")),O=Object(E["a"])(L,m,f,!1,null,"6233bf03",null),$=O.exports,T=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{key:e.dataFormKey,ref:"ruleForm",attrs:{model:e.dataForm,rules:e.rules,"label-width":"160px"}},[o("el-row",{attrs:{gutter:0}},[o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品分类",prop:"category"}},[o("FormFK",{attrs:{moduleProp:{prop:"category",refProp:"id",refModuleName:"category",showProp:"name",showPath:"category.name"},showValue:e.dataForm["category.name"]},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var i=t[a];e.$set(e.dataForm,i,o[a])}))}},model:{value:e.dataForm["category"],callback:function(t){e.$set(e.dataForm,"category",t)},expression:"dataForm['category']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品图片",prop:"listPicUrl"}},[o("FormFile",{attrs:{moduleProp:{prop:"listPicUrl",feature:"IMAGE",ruleType:1024},showUri:e.dataForm["listPicUrl"]},model:{value:e.dataForm["listPicUrl"],callback:function(t){e.$set(e.dataForm,"listPicUrl",t)},expression:"dataForm['listPicUrl']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品轮播图",prop:"galleryImgs"}},[o("FormFile",{ref:"galleryImgs",attrs:{moduleProp:{prop:"galleryImgs",feature:"IMAGE",ruleType:1024},limitSize:10,showUri:e.dataForm.galleryImgs||""},model:{value:e.dataForm.galleryImgs,callback:function(t){e.$set(e.dataForm,"galleryImgs",t)},expression:"dataForm.galleryImgs"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["name"],callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm['name']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品简介",prop:"goodsBrief"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["goodsBrief"],callback:function(t){e.$set(e.dataForm,"goodsBrief",t)},expression:"dataForm['goodsBrief']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"商品单位",prop:"goodsUnit"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["goodsUnit"],callback:function(t){e.$set(e.dataForm,"goodsUnit",t)},expression:"dataForm['goodsUnit']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"销量",prop:"sellVolume"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["sellVolume"],callback:function(t){e.$set(e.dataForm,"sellVolume",t)},expression:"dataForm['sellVolume']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"型号和价格",prop:"specificationId1"}},[o("el-select",{ref:"select",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.dataForm.specificationId1,callback:function(t){e.$set(e.dataForm,"specificationId1",t)},expression:"dataForm.specificationId1"}},e._l(e.specificationList,(function(e){return o("el-option",{key:e.name,attrs:{label:e.name,value:e.id}})})),1),o("div",{staticStyle:{"margin-top":"10px"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.productList}},[o("el-table-column",{attrs:{label:"商品SKU"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},on:{blur:function(o){return e.checkSkuOnly(t.$index,t.row)}},model:{value:t.row.goodsSn,callback:function(o){e.$set(t.row,"goodsSn",o)},expression:"scope.row.goodsSn"}})]}}])}),o("el-table-column",{attrs:{label:"快递单上的简称",width:180},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsName,callback:function(o){e.$set(t.row,"goodsName",o)},expression:"scope.row.goodsName"}})]}}])}),o("el-table-column",{attrs:{label:"型号/规格"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value",o)},expression:"scope.row.value"}})]}}])}),o("el-table-column",{attrs:{label:"成本（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.cost,callback:function(o){e.$set(t.row,"cost",o)},expression:"scope.row.cost"}})]}}])}),o("el-table-column",{attrs:{label:"零售（元）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.retailPrice,callback:function(o){e.$set(t.row,"retailPrice",o)},expression:"scope.row.retailPrice"}})]}}])}),o("el-table-column",{attrs:{label:"重量（KG）"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsWeight,callback:function(o){e.$set(t.row,"goodsWeight",o)},expression:"scope.row.goodsWeight"}})]}}])}),o("el-table-column",{attrs:{label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.goodsNumber,callback:function(o){e.$set(t.row,"goodsNumber",o)},expression:"scope.row.goodsNumber"}})]}}])}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){return e.handleDelProduct(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),o("div",{staticStyle:{"margin-top":"10px"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleAddProduct}},[e._v("新增型号")])],1)],1)],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"选择快递模板",prop:"freightTemplate"}},[o("FormFK",{attrs:{moduleProp:{prop:"freightTemplate",refProp:"id",refModuleName:"freightTemplate",showProp:"name",showPath:"freightTemplate.name"},showValue:e.dataForm["freightTemplate.name"]},on:{handleBack:function(t,o){Object.keys(t).forEach((function(a){var i=t[a];e.$set(e.dataForm,i,o[a])}))}},model:{value:e.dataForm["freightTemplate"],callback:function(t){e.$set(e.dataForm,"freightTemplate",t)},expression:"dataForm['freightTemplate']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"排序",prop:"sortOrder"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.dataForm["sortOrder"],callback:function(t){e.$set(e.dataForm,"sortOrder",t)},expression:"dataForm['sortOrder']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"首页显示",prop:"isIndex"}},[o("FormSelect",{attrs:{moduleProp:{prop:"isIndex",values:[{label:"是",value:"true"},{label:"否",value:"false"}]},showValue:e.dataForm["isIndex"]},model:{value:e.dataForm["isIndex"],callback:function(t){e.$set(e.dataForm,"isIndex",t)},expression:"dataForm['isIndex']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:12}},[o("el-form-item",{attrs:{label:"发布",prop:"isOnSale"}},[o("el-switch",{attrs:{"active-text":"上架","inactive-text":"下架"},model:{value:e.dataForm["isOnSale"],callback:function(t){e.$set(e.dataForm,"isOnSale",t)},expression:"dataForm['isOnSale']"}})],1)],1),o("el-col",{staticClass:"form-item-col",staticStyle:{"padding-right":"10%"},attrs:{xs:24,sm:24}},[o("el-form-item",{attrs:{label:"商品详情",prop:"goodsDesc"}},[o("FormEditor",{attrs:{moduleProp:{}},model:{value:e.dataForm["goodsDesc"],callback:function(t){e.$set(e.dataForm,"goodsDesc",t)},expression:"dataForm['goodsDesc']"}})],1)],1)],1)],1)],1)])])},C=[],V=(o("a15b"),o("5876"),{name:"Edit",components:{FormString:g["a"],FormText:b["a"],FormDate:v["a"],FormFK:S["a"],FormDateTime:x["a"],FormTime:F["a"],FormSelect:w["a"],FormFile:k["a"],FormEditor:y["a"]},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataFormKey:0,dataForm:{},moduleProps:this.module.props||[],rules:this.getFormRules(),pk:this.module.pk,children:this.getChildren()||[],action:{},goodsGalleryList:[],isOnSale:!0,specificationList:[],productList:[]}},created:function(){},computed:Object(n["a"])({},Object(c["b"])(["permission"])),methods:{initialize:function(e){this.getInfo(e),this.getGoodsGallerys(e),this.getChildrenData(e),this.getSpecificationList(),this.getProductList(e)},setAction:function(e){var t=this;this.action=e||{};var o=[];!this.action.props||this.action.props.length<=0?o=this.module.props:this.moduleProps.forEach((function(e){var a=t.action.props.find((function(t){return e.prop===t.prop}));if(a){var i=Object(n["a"])({},e);i.defaultValue=a.value,i.values=a.values,i.ruleType|=a.ruleType,o.push(i)}})),this.rules=this.getFormRules(o),this.moduleProps=o},getFormRules:function(e){var t={category:[{required:!0,message:"必输项",trigger:"blur"}],listPicUrl:[{required:!0,message:"必输项",trigger:"blur"}],galleryImgs:[{required:!0,message:"必输项",trigger:"blur"}],name:[{required:!0,message:"必输项",trigger:"blur"}],goodsBrief:[{required:!0,message:"必输项",trigger:"blur"}],goodsUnit:[{required:!0,message:"必输项",trigger:"blur"}],sellVolume:[{required:!0,message:"必输项",trigger:"blur"}],specificationId:[{required:!0,message:"必输项",trigger:"blur"}],freightTemplate:[{required:!0,message:"必输项",trigger:"blur"}]};return this.dataFormKey++,t},submitForm:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return e.$message({type:"error",message:"数据验证失败，请检查输入项"}),console.log("error submit!!"),!1;if(!e.productList||e.productList.length<=0)return e.$message({type:"error",message:"型号和价格的值不能为空"}),!1;var o,a=Object(h["a"])(e.productList);try{for(a.s();!(o=a.n()).done;){var i=o.value;if(!i.cost||!i.goodsSn||!i.goodsName||!i.goodsWeight||!i.retailPrice||!i.value||!i.goodsNumber)return e.$message({type:"error",message:"型号和价格的值不能为空"}),!1}}catch(l){a.e(l)}finally{a.f()}var r={};e.moduleProps.forEach((function(t){e.isHideInEdit(t.ruleType)&&!e.isID(t.ruleType)||(r[t.prop]=e.dataForm[t.prop])})),r.specificationId1=e.dataForm.specificationId1,r.galleryImgs=e.dataForm.galleryImgs,e.productList.forEach((function(e){e.isDelete=!1,e.isOnSale=!0,e.hasChange=!1})),r.productList=JSON.stringify(e.productList),Object(I["z"])(e.module.name,r).then((function(t){e.$emit("handleUpdateSuccess")})).catch((function(){}))}))},isHideInEdit:function(e){return Object(I["l"])(e)},getInfo:function(e){var t=this;Object(I["h"])(this.module.name,e[this.module.pk]).then((function(e){t.dataForm=e.data,"否"===t.dataForm.isOnSale?t.dataForm.isOnSale=!1:t.dataForm.isOnSale=!0,"否"===t.dataForm.isIndex?t.dataForm.isIndex="false":t.dataForm.isIndex="true"})).catch((function(){}))},getGoodsGallerys:function(e){var t=this;Object(I["e"])("goodsGallery",{"goods.id":e[this.module.pk]}).then((function(e){t.goodsGalleryList=e.data.content;var o=t.goodsGalleryList.map((function(e){return e.imgUrl}));t.dataForm.galleryImgs=o.join(","),t.$refs.galleryImgs.setFileList(o)})).catch((function(){}))},getSpecificationList:function(){var e=this;Object(I["e"])("specification",{_sort:"sortOrder",_direction:"asc"}).then((function(t){e.specificationList=t.data.content})).catch((function(){}))},getProductList:function(e){var t=this;Object(I["e"])("product",{"goods.id":e[this.module.pk]}).then((function(e){t.productList=e.data.content,t.productList.forEach((function(e){e.goodsId=e.goods,delete e.goods,delete e["goods.name"]}))})).catch((function(){}))},handleDelProduct:function(e,t){this.productList.splice(e,1)},handleAddProduct:function(){this.productList||(this.productList=[]),this.productList.push({})},checkSkuOnly:function(e,t){var o=this;if(console.log(e),""===t.goodsSn)return this.$message({type:"error",message:"SKU不能为空"}),!1;Object(I["e"])("product",{goodsSn:t.goodsSn}).then((function(e){e.data.content.length>0?e.data.content[0].id!==t.id&&o.$message({type:"error",message:"该SKU已存在！"}):o.$message({type:"success",message:"该SKU可以用！"})})).catch((function(){}))},getChildren:function(){var e=this,t=this.module.children||[];return t=t.filter((function(t){var o=t.props||[],a=o.filter((function(t){return!t.refModuleName&&!e.isHideInEdit(t.prop)})).length;return!(a>1)&&(t.otherRefProps&&1==t.otherRefProps.length)})),t},getChildrenData:function(e){var t=this.$refs.childrenList;t&&this.children.forEach((function(o,a){var i=o.refProp;t[a].initialize(e,i)}))},deleteData:function(){var e=this;this.$confirm("确认要删除当前数据吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={};t[e.module.pk]=e.dataForm[e.module.pk],Object(I["x"])(e.module.name,t).then((function(t){e.$emit("handleDeleteSuccess"),e.$message({type:"success",message:"删除操作执行完成"})})).catch((function(){}))})).catch((function(t){e.$message({type:"info",message:"删除已取消"})}))},isNoUpdate:I["s"],isShowInRow:I["u"],isID:I["p"]}}),D=V,j=(o("076b"),Object(E["a"])(D,T,C,!1,null,"5422e3b2",null)),U=j.exports,A=o("4270"),R=o("b7d2"),N={components:{FilterItem:u["a"],Info:p["a"],Form:$,Edit:U,ImportList:A["a"],ExportList:R["a"]},directives:{},data:function(){return{activeName:"ALL",tabViewFilters:null,_sort:"sortOrder",_direction:"ASC",fullscreen:!1,id:"",filterProps:[],viewFilters:[],module:{name:this.$route.path.split("/")[1]},currentAction:{},viewProps:[],dialogViewPropertyVisible:!1,viewPropArray:[],selectedViewPropArray:[],dataListKey:0,loading:!1,dataList:[],dataListSelection:[],dataSelection:{},pageRequest:{},dialogInfoVisible:!1,dialogFormVisible:!1,dialogEditVisible:!1}},watch:{$route:function(e){},selectedViewPropArray:function(e){var t=[];this.module.viewProps.forEach((function(o){e.indexOf(o.prop)>-1&&((o.ruleType&I["a"])===I["a"]&&(o.ruleType^=I["a"]),t.push(o))})),this.viewProps=t}},created:function(){this.id=this.$route.query.id,this.getList()},computed:Object(n["a"])({},Object(c["b"])(["fileHttpServer"])),mounted:function(){if(this.id){var e=this.$route.query._pk||"id",t={};t[e]=this.id,this.module.pk=e,this.id&&this.handleInfo(t)}},methods:(a={handleTabClick:function(e,t){console.log("tab="+e.name+", event="+t),"ALL"===e.name?this.tabViewFilters=null:"ON_SALE"===e.name?this.tabViewFilters={prop:"isOnSale",value:!0}:"SALE_OUT"===e.name?this.tabViewFilters={prop:"goodsNumber",op:"<=",value:0}:"OFF_SALE"===e.name&&(this.tabViewFilters={prop:"isOnSale",value:!1}),this.handleSearch()},handleSort:function(e){this._sort=e,this._direction="DESC",this.viewFilters=this.getViewFilters(),this.pageRequest.page=0,this.getList()},getViewFilters:function(){var e=[];return this.tabViewFilters&&e.push(this.tabViewFilters),this.filterProps.forEach((function(t){var o=t.value;Object(s["a"])(o)===Array&&(o=o[o.length-1]),t.op=t.op||t.ops.length>0?t.ops[0].value:"=";var a={prop:t.prop,op:t.op,value:o};e.push(a)})),e},handleSearch:function(){this.viewFilters=this.getViewFilters(),this.pageRequest.page=0,this._sort="sortOrder",this._direction="ASC",this.getList()},getList:function(){var e=this;if(!this.loading){this.loading=!0;var t={_vf:JSON.stringify(this.viewFilters)};t._page=this.pageRequest.page?this.pageRequest.page-1:0,t._size=this.pageRequest.size||10,t._sort=this._sort,t._direction=this._direction,Object(I["e"])(this.module.name,t).then((function(t){var o=t.data;e.dataList=o.content||[],e.pageRequest=Object.assign(o.pageable,{total:o.totalElements,page:o.number+1,size:o.size}),e.module=t.module,0===e.filterProps.length&&(e.filterProps=e.module.filterProps),0===e.viewProps.length&&e.module.viewProps.filter((function(e){return!Object(I["o"])(e.ruleType)})).forEach((function(t){e.viewProps.push(t),e.viewPropArray.push(t.prop)})),setTimeout((function(){e.loading=!1}),200)})).catch((function(){e.loading=!1}))}},handleSelectionChange:function(e){this.dataListSelection=e},handleCreate:function(e){this.dialogFormVisible=!0,this.currentAction=e},openFormDialog:function(){var e=this;this.$nextTick((function(t){e.$refs.dialogForm.setAction(e.currentAction)}))},handleFormSave:function(){this.$refs["dialogForm"].submitForm()},handleFormReset:function(){this.$refs["dialogForm"].initialize()},handleCreateSuccess:function(){this.getList(),this.dialogFormVisible=!1},handleUpdateRow:function(e,t){this.dataSelection=e,this.dialogEditVisible=!0,this.currentAction=t},handleUpdate:function(e){var t=this;this.dataListSelection.length<=0?this.$alert("请选择一行待修改的记录","警告",{confirmButtonText:"确认"}):(this.currentAction=e,this.dataSelection=this.dataListSelection[0],e.disableProp&&e.disableValues.find((function(o){return o===t.dataSelection[e.disableProp]}))?this.$alert("当前选中的记录不允许修改","错误",{confirmButtonText:"确认"}):this.dialogEditVisible=!0)},openEditDialog:function(){var e=this;this.$nextTick((function(t){e.$refs.dialogEdit.initialize(e.dataSelection),e.$refs.dialogEdit.setAction(e.currentAction)}))},handleEditSave:function(){this.$refs["dialogEdit"].submitForm()},handleEditDelete:function(){this.$refs["dialogEdit"].deleteData()},handleEditRefresh:function(){this.$refs.dialogEdit.initialize(this.dataSelection)},handleEditUpdateSuccess:function(){this.dialogEditVisible=!1,this.getList()},handleEditDeleteSuccess:function(){this.dialogEditVisible=!1,this.getList()},handleInfo:function(e){this.dialogInfoVisible=!0,this.dataSelection=e},openInfoDialog:function(){var e=this;this.$nextTick((function(t){e.$refs.dialogInfo.initialize(e.dataSelection)}))},handleInfoRefresh:function(){this.$refs.dialogInfo.initialize(this.dataSelection)},handleInfoUpdate:function(){this.dialogInfoVisible=!1,this.handleUpdateRow(this.dataSelection)},handleInfoDelete:function(){this.$refs.dialogInfo.deleteData()},handleInfoDeleteSuccess:function(){this.dialogInfoVisible=!1,this.getList()},handleDeleteRow:function(e,t){var o=this;this.$confirm("确认要删除当前记录吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={id:e.id};Object(I["x"])(o.module.name,t).then((function(e){o.getList(),o.$message({type:"success",message:"删除操作执行完成"})})).catch((function(e){}))})).catch((function(){o.$message({type:"info",message:"删除已取消"})}))},handleExecuteRow:function(e,t){var o=this;this.$confirm('确认要执行"'+t.name+'"吗？',"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var a={id:e.id};Object(I["d"])(t,a).then((function(e){o.getList(),o.$message({type:"success",message:t.name+"操作执行完成"})})).catch((function(e){}))})).catch((function(){}))},handleDelete:function(e){var t=this;if(this.dataListSelection.length<=0)this.$alert("请选择待删除的记录","警告",{confirmButtonText:"确认"});else{for(var o="确认要删除吗？",a=function(a){var i=t.dataListSelection[a];if(e.disableProp&&e.disableValues.find((function(t){return t===i[e.disableProp]})))return o="当前选中的记录中存在着已经提交且不能更改的数据，确认要删除吗？","break"},i=0;i<this.dataListSelection.length;i++){var r=a(i);if("break"===r)break}this.$confirm(o,"警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var e={id:t.dataListSelection.map((function(e){return e[t.module.pk]}))};Object(I["x"])(t.module.name,e).then((function(e){t.getList(),t.$message({type:"success",message:"删除操作执行完成"})})).catch((function(e){}))})).catch((function(){t.$message({type:"info",message:"删除已取消"})}))}},handleImport:function(){this.$refs.importList.dialogImportVisible=!0},handleImportComplete:function(){this.getList()},handleExport:function(){this.$refs.exportList.dialogExportVisible=!0}},Object(l["a"])(a,"handleSelectionChange",(function(e){this.dataListSelection=e})),Object(l["a"])(a,"handleSizeChange",(function(e){this.pageRequest.size=e,this.getList(),console.log("每页 ".concat(e," 条"))})),Object(l["a"])(a,"handleCurrentChange",(function(e){this.pageRequest.page=e,this.getList(),console.log("当前页: ".concat(e))})),Object(l["a"])(a,"getFileUrl",(function(e,t){if(Object(I["j"])(t))return e;var o=this.fileHttpServer+"";return o.endsWith("/")&&(o=o.substring(0,o.length-1)),o+e})),Object(l["a"])(a,"handlePreview",(function(e){e&&Object(d["a"])(e,"图片预览",600,600)})),Object(l["a"])(a,"isHideInList",I["o"]),Object(l["a"])(a,"isHideInInfo",I["n"]),Object(l["a"])(a,"columnMinWidth",I["b"]),Object(l["a"])(a,"isListProp",I["r"]),Object(l["a"])(a,"isAuditProp",I["k"]),Object(l["a"])(a,"isShowInRow",I["u"]),Object(l["a"])(a,"isAbsoluteFile",I["j"]),a)},q=N,z=(o("a6fb"),o("15a9"),Object(E["a"])(q,i,r,!1,null,"b292e59c",null));t["default"]=z.exports},"6d95":function(e,t,o){},7071:function(e,t,o){"use strict";var a=o("b3eb"),i=o.n(a);i.a},"832e":function(e,t,o){},"931a":function(e,t,o){"use strict";var a=o("127f"),i=o.n(a);i.a},a415:function(e,t,o){},a6fb:function(e,t,o){"use strict";var a=o("832e"),i=o.n(a);i.a},b10d:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-info-container"},[o("div",{staticClass:"example-info-body",staticStyle:{border:"0px solid #d2d6de"}},[o("div",[o("el-form",{ref:"ruleForm",staticStyle:{padding:"15px 20px"},attrs:{"label-width":"150px"}},[o("el-row",{attrs:{gutter:0}},[e._l(e.module.viewProps,(function(t){return[e.isAuditProp(t.ruleType)?e._e():o("el-col",{key:t.prop,staticStyle:{"padding-right":"8%"},attrs:{xs:24,sm:e.isShowInRow(t)?24:12}},[e.isHideInInfo(t.ruleType)?e._e():o("el-form-item",{attrs:{label:t.name}},["IMAGE"===t.feature&&e.dataInfo[t.prop]?o("div",[o("a",{attrs:{href:"#"},on:{click:function(o){e.handlePreview(e.getFileUrl(e.dataInfo[t.prop],t.ruleType))}}},[o("img",{staticStyle:{"max-width":"600px"},attrs:{src:e.getFileUrl(e.dataInfo[t.prop],t.ruleType)}})])]):"FILE"===t.feature&&e.dataInfo[t.prop]?o("div",[o("a",{attrs:{href:e.getFileUrl(e.dataInfo[t.prop],t.ruleType),target:"_blank"}},[o("i",{staticClass:"el-icon-document"})])]):"EDITOR"===t.feature&&e.dataInfo[t.prop]?o("div",[o("div",{domProps:{innerHTML:e._s(e.dataInfo[t.prop])}})]):o("div",[e._v(e._s(e.dataInfo[t.prop])+" ")])])],1)]}))],2),o("el-row",[e._l(e.module.viewProps,(function(t){return[e.isAuditProp(t.ruleType)?o("el-col",{key:t.prop,staticStyle:{"padding-right":"8%"},attrs:{xs:24,sm:e.isShowInRow(t)?24:12}},[e.isHideInInfo(t.ruleType)?e._e():o("el-form-item",{attrs:{label:t.name}},["IMAGE"===t.feature&&e.dataInfo[t.prop]?o("div",[o("a",{attrs:{href:"#"},on:{click:function(o){e.handlePreview(e.getFileUrl(e.dataInfo[t.prop],t.ruleType))}}},[o("img",{staticStyle:{"max-width":"600px"},attrs:{src:e.getFileUrl(e.dataInfo[t.prop],t.ruleType)}})])]):"FILE"===t.feature&&e.dataInfo[t.prop]?o("div",[o("a",{attrs:{href:e.getFileUrl(e.dataInfo[t.prop],t.ruleType),target:"_blank"}},[o("i",{staticClass:"el-icon-document"})])]):"EDITOR"===t.feature&&e.dataInfo[t.prop]?o("div",[o("div",{domProps:{innerHTML:e._s(e.dataInfo[t.prop])}})]):o("div",[e._v(e._s(e.dataInfo[t.prop]))])])],1):e._e()]}))],2)],1)],1)]),e._l(this.module.children,(function(t){return o("section",{key:"_info_children_"+t.name},[o("Children",{key:"_children_"+t.name,ref:"childrenList",refInFor:!0,attrs:{parent:e.module,module:t}})],1)}))],2)},i=[],r=(o("4160"),o("b0c0"),o("8a79"),o("159b"),o("5530")),l=o("5876"),s=o("2f62"),n=o("3e10"),c=o("1e3b"),d={name:"info",components:{Children:l["a"]},props:{module:{type:Object,required:!0,default:{}}},data:function(){return{dataInfo:{},pageRequest:{}}},created:function(){},computed:Object(r["a"])({},Object(s["b"])(["fileHttpServer"])),methods:{initialize:function(e){this.getInfo(e),this.module.children&&this.getChildrenData(e)},getInfo:function(e){var t=this;Object(c["h"])(this.module.name,e[this.module.pk]).then((function(e){t.dataInfo=e.data;var o=!t.module.children;t.module=e.module,o&&t.getChildrenData(t.dataInfo)})).catch((function(){}))},deleteData:function(){var e=this;this.$confirm("确认要删除当前数据吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var t={};t[e.module.pk]=e.dataInfo[e.module.pk],Object(c["x"])(e.module.name,t).then((function(t){e.$emit("handleDeleteSuccess"),e.$message({type:"success",message:"删除操作执行完成"})})).catch((function(){}))})).catch((function(){e.$message({type:"info",message:"删除已取消"})}))},getChildrenData:function(e){var t=this.$refs.childrenList;t&&this.module.children.forEach((function(o,a){var i=o.refProp;t[a].initialize(e,i)}))},getFileUrl:function(e,t){if(this.isAbsoluteFile(t))return e;var o=this.fileHttpServer+"";return o.endsWith("/")&&(o=o.substring(0,o.length-1)),o+e},handlePreview:function(e){e&&Object(n["a"])(e,"图片预览",600,600)},isHideInInfo:c["n"],isAuditProp:c["k"],isShowInRow:c["u"],isAbsoluteFile:c["j"]}},u=d,p=(o("931a"),o("2877")),m=Object(p["a"])(u,a,i,!1,null,"5f47fbdb",null);t["a"]=m.exports},b3eb:function(e,t,o){},b4d8:function(e,t,o){},b7d2:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"example-export-dialog"},[o("el-dialog",{attrs:{visible:e.dialogExportVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogExportVisible=t}}},[o("div",{attrs:{slot:"title"},slot:"title"},[e._v("导出"+e._s(e.module.showName))]),o("el-form",{ref:"exportPanel",attrs:{"label-width":"120px"}},[o("el-form-item",{attrs:{label:"文件名"}},[o("el-input",{attrs:{"prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1),o("el-form-item",{attrs:{label:"文件类型"}},[o("el-select",{model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}},[o("el-option",{attrs:{label:"xlsx",value:"xlsx"}}),o("el-option",{attrs:{label:"csv",value:"csv"}}),o("el-option",{attrs:{label:"txt",value:"txt"}})],1)],1),o("el-form-item",{attrs:{label:"自动列宽"}},[o("el-radio-group",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}},[o("el-radio",{attrs:{label:!0,border:""}},[e._v("是")]),o("el-radio",{attrs:{label:!1,border:""}},[e._v("否")])],1)],1),o("el-form-item",{attrs:{label:"导出范围"}},[o("el-radio-group",{model:{value:e.dataRange,callback:function(t){e.dataRange=t},expression:"dataRange"}},[o("el-radio",{attrs:{label:"PAGE",border:""}},[e._v("当前查询页")]),o("el-radio",{attrs:{label:"SELECT",border:""}},[e._v("当前选中行")])],1)],1)],1),o("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary",loading:e.downloadLoading},on:{click:e.handleExport}},[e._v("导出")]),o("el-button",{on:{click:function(t){e.dialogExportVisible=!1}}},[e._v("取消")])],1)],1)],1)},i=[],r=(o("d81d"),o("b0c0"),o("d3b7"),o("ed08")),l={name:"DataExport",components:{},props:{module:{type:Object,default:{}},selectedPropArray:{type:Array},dataList:{type:Array,required:!0},dataListSelection:{type:Array}},data:function(){return{dialogExportVisible:!1,autoWidth:!0,bookType:"xlsx",dataRange:"PAGE",downloadLoading:!1}},computed:{filename:function(){return this.module.name+"_"+Object(r["d"])(new Date,"{y}{m}{d}{h}{i}{s}")}},methods:{handleExport:function(){var e=this;this.downloadLoading=!0;var t=this.selectedPropArray,a=this.dataList;"SELECT"==this.dataRange&&(a=this.dataListSelection),a=this.formatJson(t,a),Promise.all([o.e("chunk-5b0190f0"),o.e("chunk-09290bef")]).then(o.bind(null,"4bf8")).then((function(o){o.export_json_to_excel({header:t,data:a,filename:e.filename,autoWidth:e.autoWidth,bookType:e.bookType}),e.downloadLoading=!1,e.dialogExportVisible=!1})).catch((function(){e.downloadLoading=!1}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?Object(r["d"])(t[e]):t[e]}))}))}}},s=l,n=(o("0c7e"),o("2877")),c=Object(n["a"])(s,a,i,!1,null,"21a94001",null);t["a"]=c.exports},f8f1:function(e,t,o){"use strict";var a=o("488d"),i=o.n(a);i.a}}]);